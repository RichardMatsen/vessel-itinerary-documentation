<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Project Structure | Vessel Itinerary Interface</title>
    <meta name="description" content="Vessel Itinerary Interface">
    
    
    <link rel="preload" href="/vessel-itinerary-documentation/assets/css/styles.27e4b5be.css" as="style"><link rel="preload" href="/vessel-itinerary-documentation/assets/js/app.27e4b5be.js" as="script"><link rel="preload" href="/vessel-itinerary-documentation/assets/js/9.3dd8e541.js" as="script"><link rel="preload" href="/vessel-itinerary-documentation/assets/css/4.styles.998e9c4c.css" as="style"><link rel="preload" href="/vessel-itinerary-documentation/assets/js/4.998e9c4c.js" as="script"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/css/1.styles.7290dcca.css"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/1.7290dcca.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/css/2.styles.8b016450.css"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/2.8b016450.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/3.fcc4bee2.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/5.a6e9ca87.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/6.29aff60d.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/7.8cc1e7b2.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/8.40583eae.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/10.1f1985d1.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/11.ebbe55ed.js"><link rel="prefetch" href="/vessel-itinerary-documentation/assets/js/12.f368fba2.js">
    <link rel="stylesheet" href="/vessel-itinerary-documentation/assets/css/4.styles.998e9c4c.css"><link rel="stylesheet" href="/vessel-itinerary-documentation/assets/css/styles.27e4b5be.css"><link rel="stylesheet" href="/vessel-itinerary-documentation/assets/css/1.styles.7290dcca.css"><link rel="stylesheet" href="/vessel-itinerary-documentation/assets/css/2.styles.8b016450.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vessel-itinerary-documentation/" class="home-link router-link-active"><!----> <span class="site-name">Vessel Itinerary Interface</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vessel-itinerary-documentation/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/challenges.html" class="nav-link">Challenges</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/structure.html" class="nav-link router-link-exact-active router-link-active">Project Structure</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/testing.html" class="nav-link">Testing</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vessel-itinerary-documentation/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/challenges.html" class="nav-link">Challenges</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/structure.html" class="nav-link router-link-exact-active router-link-active">Project Structure</a></div><div class="nav-item"><a href="/vessel-itinerary-documentation/testing.html" class="nav-link">Testing</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Project Structure</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vessel-itinerary-documentation/structure.html#environment" class="sidebar-link">Environment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vessel-itinerary-documentation/structure.html#the-dts-package" class="sidebar-link">The DTS package</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vessel-itinerary-documentation/structure.html#transact-sql-components" class="sidebar-link">Transact SQL Components</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vessel-itinerary-documentation/structure.html#applying-actions" class="sidebar-link">Applying Actions</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="project-structure"><a href="#project-structure" aria-hidden="true" class="header-anchor">#</a> Project Structure</h1> <h2 id="environment"><a href="#environment" aria-hidden="true" class="header-anchor">#</a> Environment</h2> <p>The project was developed in a VMWare WorkStation virtual machine, to allow easy hand-off to the client and to the support staff. This VM contained itâ€™s own copy of Oracle 9i as the source database and SQL Server 2000 as the target database.</p> <p>It included all source material and unit tests which were performed against the actual databases in the VM. Since the MAPS database is quite large, the connections could be pointed at an external copy of the production data by changing the connection strings (implemented by UDL files).</p> <p>The project consists of</p> <ul><li>A DTS package as the application framework</li> <li>Business logic in Transact SQL scripts</li> <li>A generic loader application in C# to provide the final loading and logging support.</li></ul> <h2 id="the-dts-package"><a href="#the-dts-package" aria-hidden="true" class="header-anchor">#</a> The DTS package</h2> <p>DTS graphically shows the application flow which allows support staff to quickly understand the steps occurring within the application.</p> <br> <figure><img src="/vessel-itinerary-documentation/assets/img/dts-package.e2cd511d.png" alt="dts-package"> <figcaption><i>(click to enlarge)</i></figcaption></figure> <p>The DTS package handles transport layer steps, i.e selecting which records in the source system are new since the last process run, and filtering out records not required.</p> <p>Data is transferred into staging tables on the target server which are a mirror image of the source tables. This ensures minimal stress during the transfer and validation can occur in the subsequent step, which is run entirely on the target server.</p> <h2 id="transact-sql-components"><a href="#transact-sql-components" aria-hidden="true" class="header-anchor">#</a> Transact SQL Components</h2> <p>All of the the business logic occurs in the TSQL components, which makes it</p> <ul><li>accessible to support staff</li> <li>can be visually validated by executing views</li> <li>easily testable against real data</li></ul> <p>The code is a hierarchy of stored procedures and SQL views which validates the incoming records and produces lists of data to be actioned, and lists of data errors.</p> <p>Validation includes checking to see if an incoming record might overwrite data that has been edited in the target system, thus protecting any changes made by users.</p> <p>Transformations are performed to handle data in various stages of update, for example the arrival date is calculated by the following expression in a SQL view:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>Arrival <span class="token operator">=</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>vd<span class="token punctuation">.</span>ActualArrival<span class="token punctuation">,</span> vd<span class="token punctuation">.</span>ScheduledArrival<span class="token punctuation">,</span> vd<span class="token punctuation">.</span>ActualPilotOnBoard<span class="token punctuation">,</span>
                   vd<span class="token punctuation">.</span>ScheduledPilotOnBoard<span class="token punctuation">)</span><span class="token punctuation">,</span>

ArrivalStatus <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> vd<span class="token punctuation">.</span>ActualArrival         <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token string">'Actual'</span>
                     <span class="token keyword">WHEN</span> vd<span class="token punctuation">.</span>ScheduledArrival      <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token string">'Scheduled'</span>
                     <span class="token keyword">WHEN</span> vd<span class="token punctuation">.</span>ActualPilotOnBoard    <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token string">'ActPilot'</span>
                     <span class="token keyword">WHEN</span> vd<span class="token punctuation">.</span>ScheduledPilotOnBoard <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token string">'SchedPilot'</span>
                     <span class="token keyword">ELSE</span> <span class="token string">'&lt;No Date&gt;'</span> <span class="token keyword">END</span><span class="token punctuation">,</span>
</code></pre></div><p>After validation, the SQL code establishes actions to be taken (Insert, Update, Delete) by comparing the incoming data to existing data. Each Action has two parts, a view which provides the data records and a stored procedure to implement the action.</p> <h2 id="applying-actions"><a href="#applying-actions" aria-hidden="true" class="header-anchor">#</a> Applying Actions</h2> <p>The actions are applied by a C# Updater program which does not contain any business logic, it simply looks for SQL views and stored procs following a naming convention.</p> <br> <figure><img src="/vessel-itinerary-documentation/assets/img/applying-actions.1a137814.png" alt="applying-actions"> <figcaption><i>(click to enlarge)</i></figcaption></figure> <br> <ul><li><p><strong>Known Error Views</strong><br>
These select incoming records with a particular error condition</p></li> <li><p><strong>bvx_VoyageDetail_Errors</strong><br>
This view collates the errors and is a source for the error report</p></li> <li><p><strong>bxv_VoyageDetail_Valid</strong><br>
Selects all incoming records which are not in the errors view</p></li> <li><p><strong>Data Views</strong><br>
Splits the valid records by action type</p></li> <li><p><strong>Apply Action Commands</strong><br>
Uses the data views to apply changes to target tables</p></li> <li><p><strong>Warning Views</strong><br>
As per error views, but non-blocking (note this also checks for existing roster postings which have been invalidated by a vessel itinerary change)</p></li></ul> <div class="minimap-container" style="width:250px;" data-v-7ac90e02><div class="minimap" style="top:250px;zoom:25%;" data-v-7ac90e02><div data-v-7ac90e02></div></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/vessel-itinerary-documentation/assets/js/9.3dd8e541.js" defer></script><script src="/vessel-itinerary-documentation/assets/js/4.998e9c4c.js" defer></script><script src="/vessel-itinerary-documentation/assets/js/app.27e4b5be.js" defer></script>
  </body>
</html>
